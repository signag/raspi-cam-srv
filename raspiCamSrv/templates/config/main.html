{% extends 'base.html' %}

{% block header %}
    {% block title %}Camera Configurations{% endblock %}
    <style>
        .inputfile {
            width: 0.1px;
            height: 0.1px;
            opacity: 0;
            overflow: hidden;
            position: absolute;
            z-index: -1;
        }
        .inputfile:focus + label {
            outline: 1px dotted #000;
            outline: -webkit-focus-ring-color auto 5px;
        }        
    </style>
{% endblock %}

{% block content %}
    <div class="w3-bar w3-green">
        <!-- Config menue -->
        {% if sc.lastConfigTab == "cfgtuning" %}
        <button class="w3-bar-item w3-button configmenu w3-light-green" id="cfgtuningbtn"
            onclick="openCfgTab('cfgtuning', 'cfgtuningbtn')">Tuning</button>
        {% else %}
        <button class="w3-bar-item w3-button configmenu" id="cfgtuningbtn" 
            onclick="openCfgTab('cfgtuning', 'cfgtuningbtn')">Tuning</button>
        {% endif %}
        {% if sc.lastConfigTab == "cfglive" %}
        <button class="w3-bar-item w3-button configmenu w3-light-green" id="cfglivebtn" 
            onclick="openCfgTab('cfglive', 'cfglivebtn')">Live View</button>
        {% else %}
        <button class="w3-bar-item w3-button configmenu" id="cfglivebtn" 
            onclick="openCfgTab('cfglive', 'cfglivebtn')">Live View</button>
        {% endif %}
        {% if sc.lastConfigTab == "cfgphoto" %}
        <button class="w3-bar-item w3-button configmenu w3-light-green" id="cfgphotobtn" 
            onclick="openCfgTab('cfgphoto', 'cfgphotobtn')">Photo</button>
        {% else %}
        <button class="w3-bar-item w3-button configmenu" id="cfgphotobtn" 
            onclick="openCfgTab('cfgphoto', 'cfgphotobtn')">Photo</button>
        {% endif %}
        {% if sc.lastConfigTab == "cfgraw" %}
        <button class="w3-bar-item w3-button configmenu w3-light-green" id="cfgrawbtn"
            onclick="openCfgTab('cfgraw', 'cfgrawbtn')">Raw Photo</button>
        {% else %}
        <button class="w3-bar-item w3-button configmenu" id="cfgrawbtn"
            onclick="openCfgTab('cfgraw', 'cfgrawbtn')">Raw Photo</button>
        {% endif %}
        {% if sc.lastConfigTab == "cfgvideo" %}
        <button class="w3-bar-item w3-button configmenu w3-light-green" id="cfgvideobtn"
            onclick="openCfgTab('cfgvideo', 'cfgvideobtn')">Video</button>
        {% else %}
        <button class="w3-bar-item w3-button configmenu" id="cfgvideobtn" 
            onclick="openCfgTab('cfgvideo', 'cfgvideobtn')">Video</button>
        {% endif %}
        <div class="w3-bar-item w3-right" style="padding-top:2px; padding-bottom:0">
            <form method="post" id="syncaspectratiofrm" action="{{ url_for('config.syncAspectRatio') }}">
                <table style="position:absolute;right:100px">
                    <tr>
                        <td>
                            <input id="activecfgtab" name="activecfgtab" value="-" style="display: none">
                        </td>
                        <td class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                               If checked, Stream Size for all other configurations will be adjusted 
                               so that the aspect ratio is identical with the current configuration.
                            </span>
                            <label for="syncaspectratio">Sync Aspect Ratio:</label>
                        </td>
                        <td >
                            {% if sc.syncAspectRatio == true %}
                            <input type="checkbox" id="syncaspectratio" name="syncaspectratio" aria-label="SyncAspectRatio" onchange="syncAspectRatio('syncaspectratiofrm')" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="syncaspectratio" name="syncaspectratio" aria-label="SyncAspectRatio" onchange="syncAspectRatio('syncaspectratiofrm')" value="0">
                            {% endif %}
                        </td>
                    </tr>
                </table>
            </form>
            <div class="w3-tooltip">
                <span style="position:absolute;right:45px;top:5px;width:200px" class="w3-text w3-tag">Online help from
                    GitHub
                </span>
                <img src="{{ url_for('static', filename='onlineHelp.png') }}" class="w3-image" id="onlinehelp" alt="Online help"
                    style="height:34px; width:34px" onclick="onlineHelp()">
            </div>
        </div>
    </div>
    <!-- Tuning configuration -->
    {% if sc.lastConfigTab == "cfgtuning" %}
    <div id="cfgtuning" class="cfggroup">
    {% else %}
    <div id="cfgtuning" class="cfggroup" style="display:none">
    {% endif %}
        <h4>Configuration for Tuning</h4>
        <div>
            <form method="post" action="{{ url_for('config.tuningCfg') }}">
                <table class="w3-table-all">
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                When activated, the specified tuning file will be loaded when the camera is initialized.
                            </span>
                            <label for="loadtuningfile">Load Tuning File:</label>
                        </td>
                        <td style="width:65%">
                            {% if tc.loadTuningFile == True %}
                            <input type="checkbox" id="loadtuningfile" name="loadtuningfile" onchange="blockTuningFileDeletion()" aria-label="loadTuningFile" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="loadtuningfile" name="loadtuningfile" onchange="blockTuningFileDeletion()" aria-label="loadTuningFile" value="0">
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Path to folder where tuning files are located.<br>
                                Leave empty for default.
                            </span>
                            <label for="tuningfolder">Full Path to Folder with Tuning Files:</label>
                        </td>
                        <td style="width:65%">
                            {% if tc.tuningFolder == None %}
                            <input style="width:100%" id="tuningfolder" name="tuningfolder" onchange="blockTuningFileDeletion()" value="">
                            {% else %}
                            <input style="width:100%" id="tuningfolder" name="tuningfolder" onchange="blockTuningFileDeletion()" value="{{ tc.tuningFolder }}">
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                File name of tuning file to be loaded.
                            </span>
                            <label for="tuningfile">Name of Tuning File:</label>
                        </td>
                        <td style="width:65%">
                            <select style="width:100%" name="tuningfile" id="tuningfile" onchange="blockTuningFileDeletion()">
                                {% for fil in tfl %}
                                {% if tc.tuningFile == fil %}
                                <option value="{{ fil }}" selected>{{ fil }}</option>
                                {% else %}
                                <option value="{{ fil }}">{{ fil }}</option>
                                {% endif %}
                                {% endfor %}
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%"></td>
                        <td style="width:30%"></td>
                        <td style="width:65%">
                            For tweaking the tuning file, see <a href="https://datasheets.raspberrypi.com/camera/raspberry-pi-camera-guide.pdf" target="_blank">Tuning Guide</a>
                            chapter 6.8
                        </td>
                    </tr>
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 30ch" type="submit" value="Submit & Apply">
                <p style="margin-bottom: 0"></p>
                <hr>
                <p style="margin-bottom: 0"></p>
            </form>
            {% if tc.isDefaultFolder == True %}
            <form method="post" action="{{ url_for('config.customTuning') }}">
                <input class="w3-button w3-black" style="width: 30ch" type="submit" value="Custom Folder">
            </form>
            {% else %}
            <form method="post" action="{{ url_for('config.defaultTuning') }}">
                <input class="w3-button w3-black" style="width: 30ch" type="submit" value="Default Folder">
            </form>
            {% endif %}
            <p style="margin-bottom: 0"></p>
            {% if tc.isDefaultFolder == True or tc.loadTuningFile == True %}
            <form id="deletetuningfile" method="post" action="{{ url_for('config.deleteTuningFile') }}">
                <input id="deletetuningfilebtn" class="w3-button w3-black" style="width: 30ch" type="submit"
                    onclick="confirmDeleteTuningFile('deletetuningfile')" value="Delete Tuning File" disabled>
            </form>
            {% else %}
            <form id="deletetuningfile" method="post" action="{{ url_for('config.deleteTuningFile') }}">
                <input id="deletetuningfilebtn" class="w3-button w3-black" style="width: 30ch" type="submit"
                    onclick="confirmDeleteTuningFile('deletetuningfile')" value="Delete Tuning File">
            </form>
            {% endif %}
            <p style="margin-bottom: 0"></p>
            <form method="post" action="{{ url_for('config.downloadTuningFile') }}">
                <input class="w3-button w3-black" style="width: 30ch" type="submit" value="Download Tuning File">
            </form>
            <p style="margin-bottom: 0"></p>
            <!-- 
                Solution for styling file upload from
                https://tympanus.net/codrops/2015/09/15/styling-customizing-file-inputs-smart-way/
            -->
            {% if tc.isDefaultFolder == True %}
            <form action="{{ url_for('config.uploadTuningFile') }}" method="post" enctype="multipart/form-data">
                <input class="w3-button w3-black" style="width: 30ch" type="submit" value="Select Tuning File for Upload" disabled>
                <br>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 30ch" type="submit" value="Upload selected File" disabled>
            </form>
            {% else %}
            <form action="{{ url_for('config.uploadTuningFile') }}" method="post" enctype="multipart/form-data">
                <input class="inputfile" id="uploadtuningfile" style="width: 40ch" type="file" accept=".json"
                    data-multiple-caption="{count}" name="tuningfile" multiple />
                <label id="uploadtuningfilelbl" class="w3-button w3-black" style="width: 30ch" for="uploadtuningfile">
                    Select Tuning File for Upload
                </label>
                <br>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 30ch"  type="submit" value="Upload selected File">
            </form>
            {% endif %}
        </div>
    </div>

    <!-- Live View configuration -->
    {% if sc.lastConfigTab == "cfglive" %}
    <div id="cfglive" class="cfggroup">
    {% else %}
    <div id="cfglive" class="cfggroup" style="display:none">
    {% endif %}
        <h4>Configuration for Live View</h4>
        {% set cfg = cfglive %}
        <div>
            <form method="post" action="{{ url_for('config.liveViewCfg') }}">
                <table class="w3-table-all">
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This is the unique ID of the configuration. It is only used to distinguish
                                different configuration sets within this application. 
                                It is not relevant for the camera system.
                            </span>
                            <label for="LIVE_id">ID:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="LIVE_id" name="LIVE_id" value="{{ cfg.id }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Usecase for this configuration.
                            </span>
                            <label for="LIVE_use_case">Use Case:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="LIVE_use_case" name="LIVE_use_case" value="{{ cfg.use_case }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether camera images are horizontally or vertically mirrored, 
                                or both (giving a 180 degree rotation).
                            </span>
                            <label for="LIVE_transform_hflip">Transform (flip ↔ or ↕ ):</label>
                        </td>
                        <td style="width:10%">
                            ↔
                            {% if cfg.transform_hflip == true %}
                            <input type="checkbox" id="LIVE_transform_hflip" name="LIVE_transform_hflip" aria-label="LIVE_transform_hflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="LIVE_transform_hflip" name="LIVE_transform_hflip" aria-label="LIVE_transform_hflip" value="0">
                            {% endif %}
                        </td>
                        <td style="width:10%">
                            ↕
                            {% if cfg.transform_vflip == true %}
                            <input type="checkbox" id="LIVE_transform_vflip" name="LIVE_transform_vflip" aria-label="LIVE_transform_vflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="LIVE_transform_vflip" name="LIVE_transform_vflip" aria-label="LIVE_transform_vflip" value="0">
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                The colour space of the output images. 
                                The main and lores streams must always share the same colour space.
                                The raw stream is always in a camera-specific colour space.
                            </span>
                            <label for="LIVE_colour_space">Colour Space:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="LIVE_colour_space" id="LIVE_colour_space">
                                {% if cfg.colour_space == "sYCC" %}
                                <option value="sYCC" selected>sYCC</option>
                                {% else %}
                                <option value="sYCC">sYCC</option>
                                {% endif %}
                                {% if cfg.colour_space == "Smpte170m" %}
                                <option value="Smpte170m" selected>Smpte170m</option>
                                {% else %}
                                <option value="Smpte170m">Smpte170m</option>
                                {% endif %}
                                {% if cfg.colour_space == "Rec709" %}
                                <option value="Rec709" selected>Rec709</option>
                                {% else %}
                                <option value="Rec709">Rec709</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                the number of sets of buffers to allocate for the camera system. 
                                A single set of buffers represents
                                one buffer for each of the streams that have been requested.
                            </span>
                            <label for="LIVE_buffer_count">Buffer Count:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input type="number" id="LIVE_buffer_count" name="LIVE_buffer_count" min="1" max="6" value="{{ cfg.buffer_count }}">
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is allowed to queue up a frame 
                                ready for a capture request.
                            </span>
                            <label for="LIVE_queue">Queue:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            {% if cfg.queue == True %}
                            <input type="checkbox" id="LIVE_queue" name="LIVE_queue" aria-label="LIVE_queue" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="LIVE_queue" name="LIVE_queue" aria-label="LIVE_queue" value="0">
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                            <!-- This cell is used to store an invisible list of sensor mode data -->
                            {% for mode in sm %}
                            <p id="sensormode_ref{{ mode.id }}" style="display:none">Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}</p>
                            {% endfor%}
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Sensor Mode to be used in this configuration<br>
                                For details, see the available Sensor Modos under 'Info'
                            </span>
                            <label for="LIVE_sensor_mode">Sensor Mode:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="LIVE_sensor_mode" id="LIVE_sensor_mode" 
                                onchange="sensorModeChanged('LIVE_sensor_mode', 'LIVE_sensor_mode_data', 'LIVE_stream_size_width', 'LIVE_stream_size_height', 'LIVE_stream_size_align')">
                                {% for mode in sm %}
                                {% if cfg.sensor_mode == mode.id %}
                                <option value="{{ mode.id }}" selected>Sensor Mode {{ mode.id }}</option>
                                {% else %}
                                <option value="{{ mode.id }}">Sensor Mode {{ mode.id }}</option>
                                {% endif %}
                                {% endfor%}
                                {% if cfg.sensor_mode == "custom" %}
                                <option value="custom" selected>Custom</option>
                                {% else %}
                                <option value="custom">Custom</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%" id="LIVE_sensor_mode_data">
                            {% for mode in sm %}
                            {% if cfg.sensor_mode == mode.id %}
                            Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}
                            {% endif %}
                            {% endfor%}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Camera stream to use
                            </span>
                            <label for="LIVE_stream">Stream:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="LIVE_stream" id="LIVE_stream">
                                {% if cfg.stream == "main" %}
                                <option value="main" selected>main</option>
                                {% else %}
                                <option value="main">main</option>
                                {% endif %}
                                {% if cfg.stream == "lores" %}
                                <option value="lores" selected>lores</option>
                                {% else %}
                                <option value="lores">lores</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Output size of the stream. Required if 'Custom' has been chosen for Sensor Mode
                            </span>
                            <label for="LIVE_stream_size_width">Stream Size (width, height) </label>
                        </td>
                        <td style="width:10%">
                            {% if cfg.sensor_mode == "custom" %}
                            <input type="number" id="LIVE_stream_size_width" name="LIVE_stream_size_width" min="1" max={{ cp.pixelArraySize[0] }} 
                                value="{{ cfg.stream_size[0] }}">
                            {% else %}
                            <input type="number" id="LIVE_stream_size_width" name="LIVE_stream_size_width" min="1" max={{ cp.pixelArraySize[0] }} 
                                value="{{ cfg.stream_size[0] }}" disabled>
                            {% endif %}
                        </td>
                        <td style="width:10%">
                            {% if cfg.sensor_mode == "custom" %}
                            <input type="number" id="LIVE_stream_size_height" name="LIVE_stream_size_height" aria-label="LIVE_stream_size_height" min="1" max={{ cp.pixelArraySize[1] }} 
                                value="{{ cfg.stream_size[1] }}">
                            {% else %}
                            <input type="number" id="LIVE_stream_size_height" name="LIVE_stream_size_height" aria-label="LIVE_stream_size_height" min="1" max={{ cp.pixelArraySize[1] }}
                                value="{{ cfg.stream_size[1] }}" disabled>
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is requested to align the custom output size
                                with available Sensor Modes.
                            </span>
                            <label for="LIVE_stream_size_align">Stream size aligned with Sensor Modes:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            {% if cfg.sensor_mode == "custom" %}
                            {% if cfg.stream_size_align == True %}
                            <input type="checkbox" id="LIVE_stream_size_align" name="LIVE_stream_size_align" aria-label="LIVE_stream_size_align" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="LIVE_stream_size_align" name="LIVE_stream_size_align" aria-label="LIVE_stream_size_align" value="0">
                            {% endif %}
                            {% else %}
                            {% if cfg.stream_size_align == True %}
                            <input type="checkbox" id="LIVE_stream_size_align" name="LIVE_stream_size_align" aria-label="LIVE_stream_size_align" value="1" checked disabled>
                            {% else %}
                            <input type="checkbox" id="LIVE_stream_size_align" name="LIVE_stream_size_align" aria-label="LIVE_stream_size_align" value="0" disabled>
                            {% endif %}
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Image format to be used
                            </span>
                            <label for="LIVE_format">Stream Format:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="LIVE_format" id="LIVE_format">
                                {% if cfg.format == "XBGR8888" %}
                                <option value="XBGR8888" selected>XBGR8888</option>
                                {% else %}
                                <option value="XBGR8888">XBGR8888</option>
                                {% endif %}
                                {% if cfg.format == "XRGB8888" %}
                                <option value="XRGB8888" selected>XRGB8888</option>
                                {% else %}
                                <option value="XRGB8888">XRGB8888</option>
                                {% endif %}
                                {% if cfg.format == "RGB888" %}
                                <option value="RGB888" selected>RGB888</option>
                                {% else %}
                                <option value="RGB888">RGB888</option>
                                {% endif %}
                                {% if cfg.format == "BGR888" %}
                                <option value="BGR888" selected>BGR888</option>
                                {% else %}
                                <option value="BGR888">BGR888</option>
                                {% endif %}
                                {% if cfg.format == "YUV420" %}
                                <option value="YUV420" selected>YUV420</option>
                                {% else %}
                                <option value="YUV420">YUV420</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the camera streams are to be shown in the preview window. <br>
                                Note: Preview view is not used within this applacation.
                            </span>
                            <label for="LIVE_display">Display:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="LIVE_display" name="LIVE_display" value="{{ cfg.display }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the streams are to be encoded if a video recording is started. 
                            </span>
                            <label for="LIVE_encode">Encode:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="LIVE_encode" name="LIVE_encode" value="{{ cfg.encode }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Submit & Apply">
                <p style="margin-bottom: 0"></p>
            </form>
            <h5>Controls included in Configuration</h5>
            <form method="post" action="{{ url_for('config.remLiveViewControls') }}">
                <table class="w3-table-all">
                    {% for ctrl_key, ctrl_value in cfg.controls.items() %}
                    <tr>
                        <td style="width:5%">
                            <input type="checkbox" id="sel_LIVE_{{ ctrl_key }}" name="sel_LIVE_{{ ctrl_key }}" aria-label="sel_LIVE_{{ ctrl_key }}" value="0">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <label for="LIVE_control">{{ ctrl_key }}:</label>
                        </td>
                        <td style="width:20%">
                            <input id="LIVE_control" name="LIVE_control" value="{{ ctrl_value }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    {% endfor%}
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Remove Selected Ctrls">
                <p style="margin-bottom: 0"></p>
            </form>
            <form method="post" action="{{ url_for('config.addLiveViewControls') }}">
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Add Active Ctrls">
            </form>
        </div>
    </div>

    <!-- Photo configuration -->
    {% if sc.lastConfigTab == "cfgphoto" %}
    <div id="cfgphoto" class="cfggroup">
    {% else %}
    <div id="cfgphoto" class="cfggroup" style="display:none">
    {% endif %}
        <h4>Configuration for Photo Taking</h4>
        {% set cfg = cfgphoto %}
        {% set cfgId = "FOTO" %}
        <div>
            <form method="post" action="{{ url_for('config.photoCfg') }}">
                <table class="w3-table-all">
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This is the unique ID of the configuration. It is only used to distinguish
                                different configuration sets within this application.
                                It is not relevant for the camera system.
                            </span>
                            <label for="{{ cfgId }}_id">ID:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_id" name="{{ cfgId }}_id" value="{{ cfg.id }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Usecase for this configuration.
                            </span>
                            <label for="{{ cfgId }}_use_case">Use Case:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_use_case" name="{{ cfgId }}_use_case" value="{{ cfg.use_case }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether camera images are horizontally or vertically mirrored,
                                or both (giving a 180 degree rotation).
                            </span>
                            <label for="{{ cfgId }}_transform_hflip">Transform (flip ↔ or ↕ ):</label>
                        </td>
                        <td style="width:10%">
                            ↔
                            {% if cfg.transform_hflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip" aria-label="{{ cfgId }}_transform_hflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip" aria-label="{{ cfgId }}_transform_hflip" value="0">
                            {% endif %}
                        </td>
                        <td style="width:10%">
                            ↕
                            {% if cfg.transform_vflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip" aria-label="{{ cfgId }}_transform_vflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip" aria-label="{{ cfgId }}_transform_vflip" value="0">
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                The colour space of the output images.
                                The main and lores streams must always share the same colour space.
                                The raw stream is always in a camera-specific colour space.
                            </span>
                            <label for="{{ cfgId }}_colour_space">Colour Space:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_colour_space" id="{{ cfgId }}_colour_space">
                                {% if cfg.colour_space == "sYCC" %}
                                <option value="sYCC" selected>sYCC</option>
                                {% else %}
                                <option value="sYCC">sYCC</option>
                                {% endif %}
                                {% if cfg.colour_space == "Smpte170m" %}
                                <option value="Smpte170m" selected>Smpte170m</option>
                                {% else %}
                                <option value="Smpte170m">Smpte170m</option>
                                {% endif %}
                                {% if cfg.colour_space == "Rec709" %}
                                <option value="Rec709" selected>Rec709</option>
                                {% else %}
                                <option value="Rec709">Rec709</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                the number of sets of buffers to allocate for the camera system.
                                A single set of buffers represents
                                one buffer for each of the streams that have been requested.
                            </span>
                            <label for="{{ cfgId }}_buffer_count">Buffer Count:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input type="number" id="{{ cfgId }}_buffer_count" name="{{ cfgId }}_buffer_count" min="1" max="6"
                                value="{{ cfg.buffer_count }}">
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is allowed to queue up a frame
                                ready for a capture request.
                            </span>
                            <label for="{{ cfgId }}_queue">Queue:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            {% if cfg.queue == True %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" aria-label="{{ cfgId }}_queue" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" aria-label="{{ cfgId }}_queue" value="0">
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                            <!-- This cell is used to store an invisible list of sensor mode data -->
                            {% for mode in sm %}
                            <p id="sensormode_ref{{ mode.id }}" style="display:none">Size: {{ mode.size }} FPS: {{ mode.fps }} Bit
                                Depth: {{ mode.bit_depth }}</p>
                            {% endfor%}
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Sensor Mode to be used in this configuration<br>
                                For details, see the available Sensor Modos under 'Info'
                            </span>
                            <label for="{{ cfgId }}_sensor_mode">Sensor Mode:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_sensor_mode" id="{{ cfgId }}_sensor_mode"
                                onchange="sensorModeChanged('{{ cfgId }}_sensor_mode', '{{ cfgId }}_sensor_mode_data', '{{ cfgId }}_stream_size_width', '{{ cfgId }}_stream_size_height', '{{ cfgId }}_stream_size_align')">
                                {% for mode in sm %}
                                {% if cfg.sensor_mode == mode.id %}
                                <option value="{{ mode.id }}" selected>Sensor Mode {{ mode.id }}</option>
                                {% else %}
                                <option value="{{ mode.id }}">Sensor Mode {{ mode.id }}</option>
                                {% endif %}
                                {% endfor%}
                                {% if cfg.sensor_mode == "custom" %}
                                <option value="custom" selected>Custom</option>
                                {% else %}
                                <option value="custom">Custom</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%" id="{{ cfgId }}_sensor_mode_data">
                            {% for mode in sm %}
                            {% if cfg.sensor_mode == mode.id %}
                            Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}
                            {% endif %}
                            {% endfor%}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Camera stream to use
                            </span>
                            <label for="{{ cfgId }}_stream">Stream:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_stream" id="{{ cfgId }}_stream">
                                {% if cfg.stream == "main" %}
                                <option value="main" selected>main</option>
                                {% else %}
                                <option value="main">main</option>
                                {% endif %}
                                {% if cfg.stream == "lores" %}
                                <option value="lores" selected>lores</option>
                                {% else %}
                                <option value="lores">lores</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Output size of the stream. Required if 'Custom' has been chosen for Sensor Mode
                            </span>
                            <label for="{{ cfgId }}_stream_size_width">Stream Size (width, height) </label>
                        </td>
                        <td style="width:10%">
                            {% if cfg.sensor_mode == "custom" %}
                            <input type="number" id="{{ cfgId }}_stream_size_width" name="{{ cfgId }}_stream_size_width" 
                                min="1" max={{ cp.pixelArraySize[0] }} value="{{ cfg.stream_size[0] }}">
                            {% else %}
                            <input type="number" id="{{ cfgId }}_stream_size_width" name="{{ cfgId }}_stream_size_width" 
                                min="1" max={{ cp.pixelArraySize[0] }} value="{{ cfg.stream_size[0] }}" disabled>
                            {% endif %}
                        </td>
                        <td style="width:10%">
                            {% if cfg.sensor_mode == "custom" %}
                            <input type="number" id="{{ cfgId }}_stream_size_height" name="{{ cfgId }}_stream_size_height" aria-label="{{ cfgId }}_stream_size_height" 
                                min="1" max={{ cp.pixelArraySize[1] }} value="{{ cfg.stream_size[1] }}">
                            {% else %}
                            <input type="number" id="{{ cfgId }}_stream_size_height" name="{{ cfgId }}_stream_size_height" aria-label="{{ cfgId }}_stream_size_height" 
                                min="1" max={{ cp.pixelArraySize[1] }} value="{{ cfg.stream_size[1] }}" disabled>
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is requested to align the custom output size
                                with available Sensor Modes.
                            </span>
                            <label for="{{ cfgId }}_stream_size_align">Stream size aligned with Sensor Modes:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            {% if cfg.sensor_mode == "custom" %}
                            {% if cfg.stream_size_align == True %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="0">
                            {% endif %}
                            {% else %}
                            {% if cfg.stream_size_align == True %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="1" checked disabled>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="0" disabled>
                            {% endif %}
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Image format to be used
                            </span>
                            <label for="{{ cfgId }}_format">Stream Format:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_format" id="{{ cfgId }}_format">
                                {% if cfg.format == "XBGR8888" %}
                                <option value="XBGR8888" selected>XBGR8888</option>
                                {% else %}
                                <option value="XBGR8888">XBGR8888</option>
                                {% endif %}
                                {% if cfg.format == "XRGB8888" %}
                                <option value="XRGB8888" selected>XRGB8888</option>
                                {% else %}
                                <option value="XRGB8888">XRGB8888</option>
                                {% endif %}
                                {% if cfg.format == "RGB888" %}
                                <option value="RGB888" selected>RGB888</option>
                                {% else %}
                                <option value="RGB888">RGB888</option>
                                {% endif %}
                                {% if cfg.format == "BGR888" %}
                                <option value="BGR888" selected>BGR888</option>
                                {% else %}
                                <option value="BGR888">BGR888</option>
                                {% endif %}
                                {% if cfg.format == "YUV420" %}
                                <option value="YUV420" selected>YUV420</option>
                                {% else %}
                                <option value="YUV420">YUV420</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the camera streams are to be shown in the preview window. <br>
                                Note: Preview view is not used within this applacation.
                            </span>
                            <label for="{{ cfgId }}_display">Display:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_display" name="{{ cfgId }}_display" value="{{ cfg.display }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the streams are to be encoded if a video recording is started.
                            </span>
                            <label for="{{ cfgId }}_encode">Encode:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_encode" name="{{ cfgId }}_encode" value="{{ cfg.encode }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Submit">
                <p style="margin-bottom: 0"></p>
            </form>
            <h5>Controls included in Configuration</h5>
            <form method="post" action="{{ url_for('config.remPhotoControls') }}">
                <table class="w3-table-all">
                    {% for ctrl_key, ctrl_value in cfg.controls.items() %}
                    <tr>
                        <td style="width:5%">
                            <input type="checkbox" id="sel_{{ cfgId }}_{{ ctrl_key }}" name="sel_{{ cfgId }}_{{ ctrl_key }}" aria-label="sel_{{ cfgId }}_{{ ctrl_key }}" value="0">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <label for="{{ cfgId }}_control">{{ ctrl_key }}:</label>
                        </td>
                        <td style="width:20%">
                            <input id="{{ cfgId }}_control" name="{{ cfgId }}_control" value="{{ ctrl_value }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    {% endfor%}
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Remove Selected Ctrls">
                <p style="margin-bottom: 0"></p>
            </form>
            <form method="post" action="{{ url_for('config.addPhotoControls') }}">
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Add Active Ctrls">
            </form>
        </div>    
    </div>

    <!-- Raw Photo configuration -->
    {% if sc.lastConfigTab == "cfgraw" %}
    <div id="cfgraw" class="cfggroup">
    {% else %}
    <div id="cfgraw" class="cfggroup" style="display:none">
    {% endif %}
        <h4>Configuration for Raw Photo Taking</h4>
        {% set cfg = cfgraw %}
        {% set cfgId = "PRAW" %}
        <div>
            <form method="post" action="{{ url_for('config.rawCfg') }}">
                <table class="w3-table-all">
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This is the unique ID of the configuration. It is only used to distinguish
                                different configuration sets within this application.
                                It is not relevant for the camera system.
                            </span>
                            <label for="{{ cfgId }}_id">ID:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_id" name="{{ cfgId }}_id" value="{{ cfg.id }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Usecase for this configuration.
                            </span>
                            <label for="{{ cfgId }}_use_case">Use Case:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_use_case" name="{{ cfgId }}_use_case" value="{{ cfg.use_case }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether camera images are horizontally or vertically mirrored,
                                or both (giving a 180 degree rotation).
                            </span>
                            <label for="{{ cfgId }}_transform_hflip">Transform (flip ↔ or ↕ ):</label>
                        </td>
                        <td style="width:10%">
                            ↔
                            {% if cfg.transform_hflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip" aria-label="{{ cfgId }}_transform_hflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip" aria-label="{{ cfgId }}_transform_hflip value="0">
                            {% endif %}
                        </td>
                        <td style="width:10%">
                            ↕
                            {% if cfg.transform_vflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip" aria-label="{{ cfgId }}_transform_vflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip" aria-label="{{ cfgId }}_transform_vflip" value="0">
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                The colour space of the output images.
                                The main and lores streams must always share the same colour space.
                                The raw stream is always in a camera-specific colour space.
                            </span>
                            <label for="{{ cfgId }}_colour_space">Colour Space:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_colour_space" id="{{ cfgId }}_colour_space">
                                {% if cfg.colour_space == "sYCC" %}
                                <option value="sYCC" selected>sYCC</option>
                                {% else %}
                                <option value="sYCC">sYCC</option>
                                {% endif %}
                                {% if cfg.colour_space == "Smpte170m" %}
                                <option value="Smpte170m" selected>Smpte170m</option>
                                {% else %}
                                <option value="Smpte170m">Smpte170m</option>
                                {% endif %}
                                {% if cfg.colour_space == "Rec709" %}
                                <option value="Rec709" selected>Rec709</option>
                                {% else %}
                                <option value="Rec709">Rec709</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                the number of sets of buffers to allocate for the camera system.
                                A single set of buffers represents
                                one buffer for each of the streams that have been requested.
                            </span>
                            <label for="{{ cfgId }}_buffer_count">Buffer Count:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input type="number" id="{{ cfgId }}_buffer_count" name="{{ cfgId }}_buffer_count" min="1" max="6"
                                value="{{ cfg.buffer_count }}">
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is allowed to queue up a frame
                                ready for a capture request.
                            </span>
                            <label for="{{ cfgId }}_queue">Queue:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            {% if cfg.queue == True %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" aria-label="{{ cfgId }}_queue" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" aria-label="{{ cfgId }}_queue" value="0">
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                            <!-- This cell is used to store an invisible list of sensor mode data -->
                            {% for mode in sm %}
                            <p id="sensormode_ref{{ mode.id }}" style="display:none">Size: {{ mode.size }} FPS: {{ mode.fps }} Bit
                                Depth: {{ mode.bit_depth }}</p>
                            {% endfor%}
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Sensor Mode to be used in this configuration<br>
                                For details, see the available Sensor Modos under 'Info'
                            </span>
                            <label for="{{ cfgId }}_sensor_mode">Sensor Mode:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_sensor_mode" id="{{ cfgId }}_sensor_mode"
                                onchange="sensorModeChanged('{{ cfgId }}_sensor_mode', '{{ cfgId }}_sensor_mode_data', '{{ cfgId }}_stream_size_width', '{{ cfgId }}_stream_size_height', '{{ cfgId }}_stream_size_align')">
                                {% for mode in sm %}
                                {% if cfg.sensor_mode == mode.id %}
                                <option value="{{ mode.id }}" selected>Sensor Mode {{ mode.id }}</option>
                                {% else %}
                                <option value="{{ mode.id }}">Sensor Mode {{ mode.id }}</option>
                                {% endif %}
                                {% endfor%}
                                {% if cfg.sensor_mode == "custom" %}
                                <option value="custom" selected>Custom</option>
                                {% else %}
                                <option value="custom">Custom</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%" id="{{ cfgId }}_sensor_mode_data">
                            {% for mode in sm %}
                            {% if cfg.sensor_mode == mode.id %}
                            Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}
                            {% endif %}
                            {% endfor%}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Camera stream to use
                            </span>
                            <label for="{{ cfgId }}_stream">Stream:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <!-- A T T E N T I O N : Specific for raw -->
                            <select name="{{ cfgId }}_stream" id="{{ cfgId }}_stream">
                                {% if cfg.stream == "raw" %}
                                <option value="raw" selected>raw</option>
                                {% else %}
                                <option value="raw">raw</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Output size of the stream. Required if 'Custom' has been chosen for Sensor Mode
                            </span>
                            <label for="{{ cfgId }}_stream_size_width">Stream Size (width, height) </label>
                        </td>
                        <td style="width:10%">
                            {% if cfg.sensor_mode == "custom" %}
                            <input type="number" id="{{ cfgId }}_stream_size_width" name="{{ cfgId }}_stream_size_width" 
                                min="1" max={{ cp.pixelArraySize[0] }} value="{{ cfg.stream_size[0] }}">
                            {% else %}
                            <input type="number" id="{{ cfgId }}_stream_size_width" name="{{ cfgId }}_stream_size_width" 
                                min="1" max={{ cp.pixelArraySize[0] }} value="{{ cfg.stream_size[0] }}" disabled>
                            {% endif %}
                        </td>
                        <td style="width:10%">
                            {% if cfg.sensor_mode == "custom" %}
                            <input type="number" id="{{ cfgId }}_stream_size_height" name="{{ cfgId }}_stream_size_height" aria-label="{{ cfgId }}_stream_size_height" 
                                min="1" max={{ cp.pixelArraySize[1] }} value="{{ cfg.stream_size[1] }}">
                            {% else %}
                            <input type="number" id="{{ cfgId }}_stream_size_height" name="{{ cfgId }}_stream_size_height" aria-label="{{ cfgId }}_stream_size_height" 
                                min="1" max={{ cp.pixelArraySize[1] }} value="{{ cfg.stream_size[1] }}" disabled>
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is requested to align the custom output size
                                with available Sensor Modes.
                            </span>
                            <label for="{{ cfgId }}_stream_size_align">Stream size aligned with Sensor Modes:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            {% if cfg.sensor_mode == "custom" %}
                            {% if cfg.stream_size_align == True %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="0">
                            {% endif %}
                            {% else %}
                            {% if cfg.stream_size_align == True %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="1" checked disabled>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="0" disabled>
                            {% endif %}
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Image format to be used
                            </span>
                            <label for="{{ cfgId }}_format">Stream Format:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_format" id="{{ cfgId }}_format">
                                <!-- A T T E N T I O N : Specific for raw -->
                                {% for fmt in cfgrf %}
                                {% if cfg.format == fmt %}
                                <option value="{{ fmt }}" selected>{{ fmt }}</option>
                                {% else %}
                                <option value="{{ fmt }}">{{ fmt }}</option>
                                {% endif %}
                                {% endfor %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the camera streams are to be shown in the preview window. <br>
                                Note: Preview view is not used within this applacation.
                            </span>
                            <label for="{{ cfgId }}_display">Display:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_display" name="{{ cfgId }}_display" value="{{ cfg.display }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the streams are to be encoded if a video recording is started.
                            </span>
                            <label for="{{ cfgId }}_encode">Encode:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_encode" name="{{ cfgId }}_encode" value="{{ cfg.encode }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Submit">
                <p style="margin-bottom: 0"></p>
            </form>
            <h5>Controls included in Configuration</h5>
            <form method="post" action="{{ url_for('config.remRawControls') }}">
                <table class="w3-table-all">
                    {% for ctrl_key, ctrl_value in cfg.controls.items() %}
                    <tr>
                        <td style="width:5%">
                            <input type="checkbox" id="sel_{{ cfgId }}_{{ ctrl_key }}" name="sel_{{ cfgId }}_{{ ctrl_key }}" aria-label="sel_{{ cfgId }}_{{ ctrl_key }}" value="0">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <label for="{{ cfgId }}_control">{{ ctrl_key }}:</label>
                        </td>
                        <td style="width:20%">
                            <input id="{{ cfgId }}_control" name="{{ cfgId }}_control" value="{{ ctrl_value }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    {% endfor%}
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Remove Selected Ctrls">
                <p style="margin-bottom: 0"></p>
            </form>
            <form method="post" action="{{ url_for('config.addRawControls') }}">
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Add Active Ctrls">
            </form>
        </div>
    </div>

    <!-- Raw Photo configuration -->
    {% if sc.lastConfigTab == "cfgvideo" %}
    <div id="cfgvideo" class="cfggroup">
    {% else %}
    <div id="cfgvideo" class="cfggroup" style="display:none">
    {% endif %}
        <h4>Configuration for Video Recording</h4>
        {% set cfg = cfgvideo %}
        {% set cfgId = "VIDO" %}
        <div>
            <form method="post" action="{{ url_for('config.videoCfg') }}">
                <table class="w3-table-all">
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This is the unique ID of the configuration. It is only used to distinguish
                                different configuration sets within this application.
                                It is not relevant for the camera system.
                            </span>
                            <label for="{{ cfgId }}_id">ID:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_id" name="{{ cfgId }}_id" value="{{ cfg.id }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Usecase for this configuration.
                            </span>
                            <label for="{{ cfgId }}_use_case">Use Case:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_use_case" name="{{ cfgId }}_use_case" value="{{ cfg.use_case }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether camera images are horizontally or vertically mirrored,
                                or both (giving a 180 degree rotation).
                            </span>
                            <label for="{{ cfgId }}_transform_hflip">Transform (flip ↔ or ↕ ):</label>
                        </td>
                        <td style="width:10%">
                            ↔
                            {% if cfg.transform_hflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip" aria-label="{{ cfgId }}_transform_hflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_hflip" name="{{ cfgId }}_transform_hflip" aria-label="{{ cfgId }}_transform_hflip" value="0">
                            {% endif %}
                        </td>
                        <td style="width:10%">
                            ↕
                            {% if cfg.transform_vflip == true %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip" aria-label="{{ cfgId }}_transform_vflip" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_transform_vflip" name="{{ cfgId }}_transform_vflip" aria-label="{{ cfgId }}_transform_vflip" value="0">
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                The colour space of the output images.
                                The main and lores streams must always share the same colour space.
                                The raw stream is always in a camera-specific colour space.
                            </span>
                            <label for="{{ cfgId }}_colour_space">Colour Space:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_colour_space" id="{{ cfgId }}_colour_space">
                                {% if cfg.colour_space == "sYCC" %}
                                <option value="sYCC" selected>sYCC</option>
                                {% else %}
                                <option value="sYCC">sYCC</option>
                                {% endif %}
                                {% if cfg.colour_space == "Smpte170m" %}
                                <option value="Smpte170m" selected>Smpte170m</option>
                                {% else %}
                                <option value="Smpte170m">Smpte170m</option>
                                {% endif %}
                                {% if cfg.colour_space == "Rec709" %}
                                <option value="Rec709" selected>Rec709</option>
                                {% else %}
                                <option value="Rec709">Rec709</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                the number of sets of buffers to allocate for the camera system.
                                A single set of buffers represents
                                one buffer for each of the streams that have been requested.
                            </span>
                            <label for="{{ cfgId }}_buffer_count">Buffer Count:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input type="number" id="{{ cfgId }}_buffer_count" name="{{ cfgId }}_buffer_count" min="1" max="6"
                                value="{{ cfg.buffer_count }}">
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is allowed to queue up a frame
                                ready for a capture request.
                            </span>
                            <label for="{{ cfgId }}_queue">Queue:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            {% if cfg.queue == True %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" aria-label="{{ cfgId }}_queue" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_queue" name="{{ cfgId }}_queue" aria-label="{{ cfgId }}_queue" value="0">
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                            <!-- This cell is used to store an invisible list of sensor mode data -->
                            {% for mode in sm %}
                            <p id="sensormode_ref{{ mode.id }}" style="display:none">Size: {{ mode.size }} FPS: {{ mode.fps }} Bit
                                Depth: {{ mode.bit_depth }}</p>
                            {% endfor%}
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Sensor Mode to be used in this configuration<br>
                                For details, see the available Sensor Modos under 'Info'
                            </span>
                            <label for="{{ cfgId }}_sensor_mode">Sensor Mode:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_sensor_mode" id="{{ cfgId }}_sensor_mode"
                                onchange="sensorModeChanged('{{ cfgId }}_sensor_mode', '{{ cfgId }}_sensor_mode_data', '{{ cfgId }}_stream_size_width', '{{ cfgId }}_stream_size_height', '{{ cfgId }}_stream_size_align')">
                                {% for mode in sm %}
                                {% if cfg.sensor_mode == mode.id %}
                                <option value="{{ mode.id }}" selected>Sensor Mode {{ mode.id }}</option>
                                {% else %}
                                <option value="{{ mode.id }}">Sensor Mode {{ mode.id }}</option>
                                {% endif %}
                                {% endfor%}
                                {% if cfg.sensor_mode == "custom" %}
                                <option value="custom" selected>Custom</option>
                                {% else %}
                                <option value="custom">Custom</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%" id="{{ cfgId }}_sensor_mode_data">
                            {% for mode in sm %}
                            {% if cfg.sensor_mode == mode.id %}
                            Size: {{ mode.size }} FPS: {{ mode.fps }} Bit Depth: {{ mode.bit_depth }}
                            {% endif %}
                            {% endfor%}
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Camera stream to use
                            </span>
                            <label for="{{ cfgId }}_stream">Stream:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_stream" id="{{ cfgId }}_stream">
                                {% if cfg.stream == "main" %}
                                <option value="main" selected>main</option>
                                {% else %}
                                <option value="main">main</option>
                                {% endif %}
                                {% if cfg.stream == "lores" %}
                                <option value="lores" selected>lores</option>
                                {% else %}
                                <option value="lores">lores</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Output size of the stream. Required if 'Custom' has been chosen for Sensor Mode
                            </span>
                            <label for="{{ cfgId }}_stream_size_width">Stream Size (width, height) </label>
                        </td>
                        <td style="width:10%">
                            {% if cfg.sensor_mode == "custom" %}
                            <input type="number" id="{{ cfgId }}_stream_size_width" name="{{ cfgId }}_stream_size_width" 
                                min="1" max={{ cp.pixelArraySize[0] }} value="{{ cfg.stream_size[0] }}">
                            {% else %}
                            <input type="number" id="{{ cfgId }}_stream_size_width" name="{{ cfgId }}_stream_size_width" 
                                min="1" max={{ cp.pixelArraySize[0] }} value="{{ cfg.stream_size[0] }}" disabled>
                            {% endif %}
                        </td>
                        <td style="width:10%">
                            {% if cfg.sensor_mode == "custom" %}
                            <input type="number" id="{{ cfgId }}_stream_size_height" name="{{ cfgId }}_stream_size_height" aria-label="{{ cfgId }}_stream_size_height" 
                                min="1" max={{ cp.pixelArraySize[1] }} value="{{ cfg.stream_size[1] }}">
                            {% else %}
                            <input type="number" id="{{ cfgId }}_stream_size_height" name="{{ cfgId }}_stream_size_height" aria-label="{{ cfgId }}_stream_size_height" 
                                min="1" max={{ cp.pixelArraySize[1] }} value="{{ cfg.stream_size[1] }}" disabled>
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Whether the system is requested to align the custom output size
                                with available Sensor Modes.
                            </span>
                            <label for="{{ cfgId }}_stream_size_align">Stream size aligned with Sensor Modes:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            {% if cfg.sensor_mode == "custom" %}
                            {% if cfg.stream_size_align == True %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="1" checked>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="0">
                            {% endif %}
                            {% else %}
                            {% if cfg.stream_size_align == True %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="1" checked disabled>
                            {% else %}
                            <input type="checkbox" id="{{ cfgId }}_stream_size_align" name="{{ cfgId }}_stream_size_align" aria-label="{{ cfgId }}_stream_size_align" value="0" disabled>
                            {% endif %}
                            {% endif %}
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                Image format to be used
                            </span>
                            <label for="{{ cfgId }}_format">Stream Format:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <select name="{{ cfgId }}_format" id="{{ cfgId }}_format">
                                {% if cfg.format == "XBGR8888" %}
                                <option value="XBGR8888" selected>XBGR8888</option>
                                {% else %}
                                <option value="XBGR8888">XBGR8888</option>
                                {% endif %}
                                {% if cfg.format == "XRGB8888" %}
                                <option value="XRGB8888" selected>XRGB8888</option>
                                {% else %}
                                <option value="XRGB8888">XRGB8888</option>
                                {% endif %}
                                {% if cfg.format == "RGB888" %}
                                <option value="RGB888" selected>RGB888</option>
                                {% else %}
                                <option value="RGB888">RGB888</option>
                                {% endif %}
                                {% if cfg.format == "BGR888" %}
                                <option value="BGR888" selected>BGR888</option>
                                {% else %}
                                <option value="BGR888">BGR888</option>
                                {% endif %}
                                {% if cfg.format == "YUV420" %}
                                <option value="YUV420" selected>YUV420</option>
                                {% else %}
                                <option value="YUV420">YUV420</option>
                                {% endif %}
                            </select>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the camera streams are to be shown in the preview window. <br>
                                Note: Preview view is not used within this applacation.
                            </span>
                            <label for="{{ cfgId }}_display">Display:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_display" name="{{ cfgId }}_display" value="{{ cfg.display }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    <tr>
                        <td style="width:5%">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <span style="position:absolute;left:0;bottom:30px" class="w3-text w3-tag">
                                This names which (if any) of the streams are to be encoded if a video recording is started.
                            </span>
                            <label for="{{ cfgId }}_encode">Encode:</label>
                        </td>
                        <td style="width:20%" colspan="2">
                            <input id="{{ cfgId }}_encode" name="{{ cfgId }}_encode" value="{{ cfg.encode }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Submit">
                <p style="margin-bottom: 0"></p>
            </form>
            <h5>Controls included in Configuration</h5>
            <form method="post" action="{{ url_for('config.remVideoControls') }}">
                <table class="w3-table-all">
                    {% for ctrl_key, ctrl_value in cfg.controls.items() %}
                    <tr>
                        <td style="width:5%">
                            <input type="checkbox" id="sel_{{ cfgId }}_{{ ctrl_key }}" name="sel_{{ cfgId }}_{{ ctrl_key }}" aria-label="sel_{{ cfgId }}_{{ ctrl_key }}" value="0">
                        </td>
                        <td style="width:30%" class="w3-tooltip">
                            <label for="{{ cfgId }}_control">{{ ctrl_key }}:</label>
                        </td>
                        <td style="width:20%">
                            <input id="{{ cfgId }}_control" name="{{ cfgId }}_control" value="{{ ctrl_value }}" disabled>
                        </td>
                        <td style="width:45%">
                        </td>
                    </tr>
                    {% endfor%}
                </table>
                <p style="margin-bottom: 0"></p>
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Remove Selected Ctrls">
                <p style="margin-bottom: 0"></p>
            </form>
            <form method="post" action="{{ url_for('config.addVideoControls') }}">
                <input class="w3-button w3-black" style="width: 22ch" type="submit" value="Add Active Ctrls">
            </form>
        </div>
    </div>

    <script>
        function openCfgTab(cfgTabName, cfgTabButton) {
            var i;
            var x = document.getElementsByClassName("cfggroup");
            for (i = 0; i < x.length; i++) {
                x[i].style.display = "none";
            }
            document.getElementById(cfgTabName).style.display = "block";

            var b = document.getElementsByClassName("configmenu");
            for (i = 0; i < b.length; i++) {
                b[i].classList = "w3-bar-item w3-button configmenu";
            }
            document.getElementById(cfgTabButton).classList = "w3-bar-item w3-button configmenu w3-light-green";

            document.getElementById("activecfgtab").value = cfgTabName

        }

        function sensorModeChanged(srcId, tgtId, ref1Id, ref2Id, ref3Id) {
            // React on a value change of sensorMode
            // srcId: id of source element (sensor mode selection)
            // tgtId: id of field where details of sensor mode shall be shown
            // refnId: IDs for fields which need to be enabled ar disabled
            var src = document.getElementById(srcId);
            var val = src.value;
            var tgt = document.getElementById(tgtId);
            if (val == "custom"){
                tgt.innerText = ""
                document.getElementById(ref1Id).disabled = false;
                document.getElementById(ref2Id).disabled = false;
                document.getElementById(ref3Id).disabled = false;
            }else{
                var txt = document.getElementById("sensormode_ref" + val).innerText;
                tgt.innerText = txt
                document.getElementById(ref1Id).value = "";
                document.getElementById(ref2Id).value = "";
                document.getElementById(ref1Id).disabled = true;
                document.getElementById(ref2Id).disabled = true;
                document.getElementById(ref3Id).disabled = true;
            }
        }
        
        function syncAspectRatio(form) {
            document.getElementById(form).submit();
        }

        function confirmDeleteTuningFile(form) {
            if (confirm("Do you want to delete the active tuning file?")) {
                document.getElementById(form).method = "post";
                document.getElementById(form).submit();
            } else {
                document.getElementById(form).method = "get";
            }
        }

        function blockTuningFileDeletion() {
            document.getElementById("deletetuningfilebtn").disabled = true;
        }

        const upld = document.getElementById("uploadtuningfile");
        upld.addEventListener("change", function (e) {
            //On change of input file (file(s) have been selected),
            //Change label to the selected file.
            //Modified source from 
            //https://tympanus.net/codrops/2015/09/15/styling-customizing-file-inputs-smart-way/
            var upldlbl = document.getElementById("uploadtuningfilelbl");
            labelVal = upldlbl.innerHTML;
            //console.log("upldlbl.innerHTML:", labelVal);
            var fileName = '';
            if (this.files && this.files.length > 1)
                fileName = (this.getAttribute('data-multiple-caption') || '').replace('{count}', this.files.length) + ' Files selected';
            else
                fileName = e.target.value.split('\\').pop();

            //console.log("fileName:", fileName);
            if (fileName)
                upldlbl.innerHTML = fileName;
            else
                upldlbl.innerHTML = labelVal;
        })
        function onlineHelp() {
            window.open("https://github.com/signag/raspi-cam-srv/blob/main/docs/Configuration.md");
        }
    </script>
{% endblock %}